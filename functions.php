<?php
 if (!defined('_S_VERSION')) { define('_S_VERSION', '1.0.0'); } function mesh_themplate_setup() { load_theme_textdomain('mesh-themplate', get_template_directory() . '/languages'); add_theme_support('automatic-feed-links'); add_theme_support('title-tag'); add_theme_support('post-thumbnails'); register_nav_menus( array( 'menu-1' => esc_html__('Primary', 'mesh-themplate'), ) ); add_theme_support( 'html5', array( 'search-form', 'comment-form', 'comment-list', 'gallery', 'caption', 'style', 'script', ) ); add_theme_support( 'custom-background', apply_filters( 'mesh_themplate_custom_background_args', array( 'default-color' => 'ffffff', 'default-image' => '', ) ) ); add_theme_support('customize-selective-refresh-widgets'); add_theme_support( 'custom-logo', array( 'height' => 250, 'width' => 250, 'flex-width' => true, 'flex-height' => true, ) ); add_theme_support('editor-styles'); add_editor_style('/css/style-editor.css'); add_theme_support('editor-color-palette', array( array( "name" => "cyan", "slug" => "slug", "color" => "var(--cyan)" ), array( "name" => "primary", "slug" => "slug", "color" => "var(--primary)" ), array( "name" => "secondary", "slug" => "slug", "color" => "var(--secondary)" ), array( "name" => "tertiary", "slug" => "slug", "color" => "var(--tertiary)" ), array( "name" => "quaternary", "slug" => "slug", "color" => "var(--quaternary)" ), array( "name" => "success", "slug" => "slug", "color" => "var(--success)" ), array( "name" => "info", "slug" => "slug", "color" => "var(--info)" ), array( "name" => "warning", "slug" => "slug", "color" => "var(--warning)" ), array( "name" => "danger", "slug" => "slug", "color" => "var(--danger)" ), )); } add_action('after_setup_theme', 'mesh_themplate_setup'); function mesh_themplate_content_width() { $GLOBALS['content_width'] = apply_filters('mesh_themplate_content_width', 640); } add_action('after_setup_theme', 'mesh_themplate_content_width', 0); function mesh_themplate_widgets_init() { register_sidebar( array( 'name' => esc_html__('Sidebar', 'mesh-themplate'), 'id' => 'sidebar-1', 'description' => esc_html__('Add widgets here.', 'mesh-themplate'), 'before_widget' => '<section id="%1$s" class="widget %2$s">', 'after_widget' => '</section>', 'before_title' => '<h2 class="widget-title">', 'after_title' => '</h2>', ) ); } add_action('widgets_init', 'mesh_themplate_widgets_init'); function mesh_themplate_scripts() { wp_enqueue_style( 'mesh-themplate-style', get_stylesheet_directory_uri() . "/css/main.css", array(), _S_VERSION ); wp_style_add_data('mesh-themplate-style', 'rtl', 'replace'); wp_enqueue_script( 'mesh-themplate-navigation', get_template_directory_uri() . '/js/app.js', array(), _S_VERSION, true ); wp_localize_script("mesh-themplate-navigation", "ajax_url", array( 'ajax_url' => admin_url('admin-ajax.php'), "mynamespace" => array( 'rootapiurl' => esc_url_raw(rest_url()), 'nonce' => wp_create_nonce('wp_rest') ) )); } function my_theme_styles() { wp_register_style('FontAwesome', 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css'); wp_enqueue_style('FontAwesome'); } add_action('wp_enqueue_scripts', 'my_theme_styles'); function mesh_template_css($file_path, $name = 'mesh-themplate-style') { if (isset($file_path)) { wp_register_style($name, get_stylesheet_directory_uri() . "/css" . $file_path, array(), _S_VERSION); wp_enqueue_style($name); } } add_action("mesh_template_styles", "mesh_template_css", 99, 2); function mesh_template_js($file_path, $name = 'mesh-themplate-script') { if (isset($file_path)) { wp_register_script( $name, get_template_directory_uri() . "/js" . $file_path, [], _S_VERSION, true ); wp_enqueue_script($name); wp_localize_script($name, "ajax_url", array( 'ajax_url' => admin_url('admin-ajax.php'), "mynamespace" => array( 'rootapiurl' => esc_url_raw(rest_url()), 'nonce' => wp_create_nonce('wp_rest') ) )); wp_enqueue_script('qs', 'https://unpkg.com/qs/dist/qs.js'); } } add_action("mesh_template_scripts", "mesh_template_js", 10, 2); require get_template_directory() . '/inc/custom-header.php'; require get_template_directory() . '/inc/template-tags.php'; require get_template_directory() . '/inc/template-functions.php'; require get_template_directory() . '/inc/customizer.php'; if (defined('JETPACK__VERSION')) { require get_template_directory() . '/inc/jetpack.php'; } if (class_exists('WooCommerce')) { require get_template_directory() . '/inc/woocommerce.php'; } add_filter('the_content', 'so_9405896_show_template', 20, 1); function so_9405896_show_template($content) { if (is_admin() || !current_user_can('administrator')) return $content; global $template; $the_templ = '<p class="p bg-gray-light">TEMPLATE: ' . basename($template) . '</p>'; $content = sprintf($the_templ . '%s', $content); return $content; } add_filter('walker_nav_menu_start_el', 'add_arrow', 10, 4); function add_arrow($output, $item, $depth, $args) { if (in_array("menu-item-has-children", $item->classes)) { $output .= '<i class="menu-dropdown-icon btn fa-solid fa-angle-down"></i>'; } return $output; } function addToArgs($field, $compare = "=", $type = "numeric") { $value = intval(sanitize_text_field($_GET[$field])); return array( "key" => $field, "compare" => $compare, "value" => $value, 'type' => $type, ); } function property_search_callback() { header("Content-Type: application/json"); $args = array( "post_type" => "propiedad", 'orderby' => 'meta_value_num', 'meta_key' => 'precio', "posts_per_page" => -1 ); if (isset($_GET["precio"])) $args["meta_query"][] = addToArgs("precio", ">="); if (isset($_GET["cuartos"])) $args["meta_query"][] = addToArgs("cuartos", ">="); if (isset($_GET["direccion"])) $args["meta_query"][] = addToArgs("direccion", "LIKE", "CHAR"); $propiedades = new WP_Query($args); $result = array(); while ($propiedades->have_posts()) { $propiedades->the_post(); $result[] = array( "id" => get_the_ID(), "title" => get_the_title(), "permalink" => get_the_permalink(), "precio" => number_format(get_field("precio"), 0, ",", "."), ); } echo json_encode($result); wp_die(); } add_action('wp_ajax_property_search', 'property_search_callback'); add_action('wp_ajax_nopriv_property_search', 'property_search_callback'); function add_api_key($api) { $api["key"] = "APIKEY"; return $api; } function add_search_form($items, $args) { if ($args->theme_location == 'menu-1') { $items .= '<li class="menu-item menu-item-has-children">' . '<i class="fa-solid fa-person-walking-with-cane btn"></i>' . '<a>accessibility </a>' . '<i class="menu-dropdown-icon btn fa-solid fa-angle-down"></i>' . '<ul class="sub-menu">
				<li class="menu-item btn-block"id="dark-theme" >
					<i class="far fa-moon " ></i>
					<span>Toggle Dark theme</span>
				</li>
				<li class="menu-item " id="">
					<i class="fas fa-text-height pl-2"></i>
					<span>Font size</span>
					<button id="font-increase" class="bold">+</button>
					<button id="font-deincrease" class="bold">-</button>
				</li>
			</ul>' . '</li>'; } return $items; } add_filter('wp_nav_menu_items', 'add_search_form', 10, 2);; function wp_hook_draft_mode_styles() { global $post; if (!$post) return; wp_enqueue_style("wphooks-admin-css", get_stylesheet_directory_uri() . "/css/gutenberg-styles.css", [], time(), "all"); } function gutenberg_editor_assets() { global $post; if (!$post) return; wp_enqueue_style("wphooks-admin-css", get_stylesheet_directory_uri() . "/css/gutenberg-styles.css", [], _S_VERSION, "all"); wp_enqueue_script("wphooks-admin-css", get_stylesheet_directory_uri() . "/js/gutenberg.js", [], _S_VERSION, "all"); } add_action('enqueue_block_editor_assets', 'gutenberg_editor_assets', 99); function alecadd_futenberg_blocks() { wp_register_script( "custom-cta-js", get_template_directory_uri() . "/js/block.js", array("wp-blocks", 'wp-editor', "wp-i18n", "wp-components"), ); register_block_type("alecadd/custom-cta", array( "editor_script" => "custom-cta-js" )); } function disable_gutenberg_scripts() { wp_dequeue_style('wc-blocks-style'); wp_dequeue_style('wc-blocks-vendors-style'); wp_dequeue_style('contact-form-7'); wp_dequeue_style('wp-block-library'); wp_dequeue_style('wp-block-library-theme'); } add_action('mesh_template_dequeue', function () { add_filter('wp_enqueue_scripts', 'disable_gutenberg_scripts', 100); }); function mesh_disable_scripts() { wp_dequeue_script("regenerator-runtime"); wp_dequeue_script("wp-polyfill"); wp_dequeue_script("contact-form-7"); wp_dequeue_script("jquery-blockui"); wp_dequeue_script("wc-add-to-cart-extra"); wp_dequeue_script("wc-add-to-cart"); wp_dequeue_script("js-cookie"); wp_dequeue_script("woocommerce"); wp_dequeue_script("wc-cart-fragments"); wp_dequeue_script("wc-cart-fragments-extra"); wp_dequeue_script("qs"); } 